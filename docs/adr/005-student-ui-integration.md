# ADR 005: Student UI Integration (学生向けUI実装)

## Status
Accepted

## Context
学生ユーザーの帰属意識とアプリのアクティブ率を高めるため、所属（大学・高校）ごとに最適化されたUIと、コミュニティ要素（ランキング）を導入する。

## Decision

### 1. データモデルの拡張
- `schools` テーブルを新設し、学校名とロゴを管理する。
- `profiles` テーブルに `is_student`, `school_id`, `grade` カラムを追加し、学生ユーザーの識別を行う。
- `activity_logs` テーブルを新設し、ランニング・ウォーキング等の活動記録を管理する。これにより、将来的なランキング拡張（カフェ巡り、レビュー数など）に対応する。

### 2. UI/UX コンポーネント
- **StudentHeader**: 所属学校名と学生数を表示し、コミュニティ感を醸成する。
- **RankingSection**: 活動ランキング（累計走行距離）を表示し、競争要素による継続利用を促す。
- **SchoolCouponSection**: 所属学生限定の特典を表示し、実利的なメリットを提供する。

### 3. ランキング集計ロジック
- バックエンド側（Supabase）の `activity_logs` テーブルを集計する。
- 期間は月次（Monthly）とし、同一 `school_id` 内でのランキングを表示する。
- スケーラビリティを考慮し、複雑な集計は RPC (PostgreSQL Function) または Edge Functions で行うことを推奨するが、初期リリースではシンプルなクエリで実装する。

### 4. クーポン機能
- 初期リリースでは、特定の `school_id` に紐づく静的データまたはモックデータとして実装し、将来的に `coupons` テーブルとの連携を検討する。

## Consequences
- **Pros**:
  - 学生ユーザーにとって魅力的な専用機能が提供される。
  - ランキング機能により、ユーザーのアクティビティが促進される。
  - 学校単位でのプロモーションが可能になる。
- **Cons**:
  - データベーススキーマの変更が必要。
  - ランキング集計の負荷が増加する可能性がある（将来的な課題）。
